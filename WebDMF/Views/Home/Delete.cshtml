@model WebDocumentManagement_FileSharing.Models.Folder

@{
    ViewData["Title"] = "Xóa thư mục";
}

@{
    var sharedWith = ViewBag.SharedWith as IEnumerable<string>;
    bool isShared = sharedWith != null && sharedWith.Any();
}

<div class="container py-4">
    <h3 class="mb-3">Xác nhận xóa thư mục</h3>

    @if (isShared)
    {
        <div class="card mb-3">
            <div class="card-body">
                <p>Bạn sắp xóa thư mục: <strong>@Model.Name</strong></p>
                <p>Thư mục này hiện đang được chia sẻ với:</p>
                <ul>
                    @foreach (var email in sharedWith)
                    {
                        <li>@email</li>
                    }
                </ul>
                <p class="text-danger fw-bold">Lưu ý: khi bạn chuyển thư mục vào thùng rác quyền truy cập cho người được chia sẻ sẽ tạm thời mất. Quyền sẽ bị xóa hoàn toàn chỉ khi bạn xóa vĩnh viễn từ thùng rác.</p>
            </div>
        </div>

        <form asp-action="Delete" method="post" class="d-inline">
            @Html.AntiForgeryToken()
            <input type="hidden" asp-for="Id" />
            <input type="hidden" name="confirmAction" value="trash" />
            <button type="submit" class="btn btn-secondary">Chuyển vào thùng rác (tạm thời)</button>
        </form>

        <a href="@Url.Action("Index", "Documents")" class="btn btn-link ms-3">Hủy</a>
    }
    else
    {
        <div>
            <h4>Thư mục</h4>
            <hr />
            <dl class="row">
                <dt class = "col-sm-2">
                    @Html.DisplayNameFor(model => model.Name)
                </dt>
                <dd class = "col-sm-10">
                    @Html.DisplayFor(model => model.Name)
                </dd>
                <dt class = "col-sm-2">
                    @Html.DisplayNameFor(model => model.CreatedDate)
                </dt>
                <dd class = "col-sm-10">
                    @Html.DisplayFor(model => model.CreatedDate)
                </dd>
                <dt class = "col-sm-2">
                    @Html.DisplayNameFor(model => model.ParentFolder)
                </dt>
                <dd class = "col-sm-10">
                    @if (Model.ParentFolder != null)
                    {
                        @Html.DisplayFor(model => model.ParentFolder.Id)
                    }
                    else
                    {
                        <span class="text-muted">(Thư mục gốc)</span>
                    }
                </dd>
                <dt class = "col-sm-2">
                    @Html.DisplayNameFor(model => model.OwnerId)
                </dt>
                <dd class = "col-sm-10">
                    @Html.DisplayFor(model => model.OwnerId)
                </dd>
            </dl>
            
            <form asp-action="Delete" method="post">
                @Html.AntiForgeryToken()
                <input type="hidden" asp-for="Id" />
                <input type="submit" value="Chuyển vào thùng rác" class="btn btn-danger" />
                <a asp-action="Index" class="btn btn-link">Quay lại</a>
            </form>
        </div>
    }
</div>
